<!DOCTYPE html>
<html lang="it">

<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Pizzeria La Face</title>

Â  Â  <style>
Â  Â  Â  Â  * { box-sizing: border-box; }
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: Arial, sans-serif;
Â  Â  Â  Â  Â  Â  max-width: 600px;
Â  Â  Â  Â  Â  Â  margin: 20px auto;
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  }
Â  Â  Â  Â  input, textarea {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  margin: 8px 0;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  border: 1px solid #ccc;
Â  Â  Â  Â  }
Â  Â  Â  Â  button {
Â  Â  Â  Â  Â  Â  padding: 10px 15px;
Â  Â  Â  Â  Â  Â  font-size: 16px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  }
Â  Â  Â  Â  .btn-edit { background: #2196F3; }
Â  Â  Â  Â  .btn-delete { background: #F44336; }
Â  Â  Â  Â  .entry {
Â  Â  Â  Â  Â  Â  border: 1px solid #ddd;
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  margin-top: 10px;
Â  Â  Â  Â  Â  Â  border-radius: 6px;
Â  Â  Â  Â  Â  Â  background: #f9f9f9;
Â  Â  Â  Â  }
Â  Â  </style>
</head>

<body>

<h2>Pizzeria La Face</h2>
<p>Inserisci il tuo nome e i gusti di pizza preferiti:</p>

<form id="pizzaForm">
Â  Â  <label>Nome:</label>
Â  Â  <input type="text" id="name" required>

Â  Â  <label>Gusti di pizza:</label>
Â  Â  <textarea id="pizzas" rows="3" required></textarea>

Â  Â  <button type="submit" style="background:#4CAF50;">Invia</button>
</form>

<h3>Preferenze di tutta la famiglia</h3>
<div id="results">Caricamento...</div>

<script>
Â  Â  // âš ï¸ RICORDA DI SOSTITUIRE QUESTO URL con l'URL del tuo script Apps Script dopo averlo distribuito
Â  Â  const API_URL = "https://script.google.com/macros/s/AKfycbxl4tLSCLEHv4d7rYZNJHb4oi3mOtM0fO9f_6x9T_Ljmpst6Zkz2aXzWqo_I3F8g4PCWw/exec";

Â  Â  function esc(str) {
Â  Â  Â  Â  return String(str)
Â  Â  Â  Â  Â  Â  .replace(/\\/g, "\\\\")
Â  Â  Â  Â  Â  Â  .replace(/'/g, "\\'")
Â  Â  Â  Â  Â  Â  .replace(/"/g, '\\"');
Â  Â  }

Â  Â  // ðŸ“Œ INVIO DATI (AGGIUNGI)
Â  Â  document.getElementById("pizzaForm").addEventListener("submit", function (e) {
Â  Â  Â  Â  e.preventDefault();

Â  Â  Â  Â  const formData = new URLSearchParams();
Â  Â  Â  Â  formData.append("action", "add");
Â  Â  Â  Â  formData.append("name", document.getElementById("name").value.trim());
Â  Â  Â  Â  formData.append("pizzas", document.getElementById("pizzas").value.trim());

Â  Â  Â  Â  // CORRETTO: Rimosso mode: "no-cors"
Â  Â  Â  Â  fetch(API_URL, {
Â  Â  Â  Â  Â  Â  method: "POST",
Â  Â  Â  Â  Â  Â  headers: { "Content-Type": "application/x-www-form-urlencoded" },
Â  Â  Â  Â  Â  Â  body: formData.toString()
Â  Â  Â  Â  });

Â  Â  Â  Â  alert("Preferenza salvata!");
Â  Â  Â  Â  document.getElementById("name").value = "";
Â  Â  Â  Â  document.getElementById("pizzas").value = "";
Â  Â  Â  Â  setTimeout(loadEntries, 700);
Â  Â  });

Â  Â  // ðŸ—‘ ELIMINA
Â  Â  function deleteEntry(id) {
Â  Â  Â  Â  if (!confirm("Vuoi davvero eliminare questa preferenza?")) return;

Â  Â  Â  Â  const formData = new URLSearchParams();
Â  Â  Â  Â  formData.append("action", "delete");
Â  Â  Â  Â  formData.append("id", id);

Â  Â  Â  Â  // CORRETTO: Rimosso mode: "no-cors"
Â  Â  Â  Â  fetch(API_URL, {
Â  Â  Â  Â  Â  Â  method: "POST",
Â  Â  Â  Â  Â  Â  headers: { "Content-Type": "application/x-www-form-urlencoded" },
Â  Â  Â  Â  Â  Â  body: formData.toString()
Â  Â  Â  Â  });

Â  Â  Â  Â  setTimeout(loadEntries, 700);
Â  Â  }

Â  Â  // âœï¸ MODIFICA
Â  Â  function editEntry(id, oldName, oldPizzas) {
Â  Â  Â  Â  const newName = prompt("Nuovo nome:", oldName);
Â  Â  Â  Â  if (!newName) return;

Â  Â  Â  Â  const newPizzas = prompt("Nuovi gusti di pizza:", oldPizzas);
Â  Â  Â  Â  if (!newPizzas) return;

Â  Â  Â  Â  const formData = new URLSearchParams();
Â  Â  Â  Â  formData.append("action", "update");
Â  Â  Â  Â  formData.append("id", id);
Â  Â  Â  Â  formData.append("name", newName.trim());
Â  Â  Â  Â  formData.append("pizzas", newPizzas.trim());

Â  Â  Â  Â  // CORRETTO: Rimosso mode: "no-cors"
Â  Â  Â  Â  fetch(API_URL, {
Â  Â  Â  Â  Â  Â  method: "POST",
Â  Â  Â  Â  Â  Â  headers: { "Content-Type": "application/x-www-form-urlencoded" },
Â  Â  Â  Â  Â  Â  body: formData.toString()
Â  Â  Â  Â  });

Â  Â  Â  Â  setTimeout(loadEntries, 700);
Â  Â  }

Â  Â  // ðŸ”„ CARICA TUTTE LE VOCI
Â  Â  function loadEntries() {
Â  Â  Â  Â  fetch(API_URL)
Â  Â  Â  Â  Â  Â  .then(res => res.json())
Â  Â  Â  Â  Â  Â  .then(data => {
Â  Â  Â  Â  Â  Â  Â  Â  let html = "";
Â  Â  Â  Â  Â  Â  Â  Â  data.forEach(row => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  html += `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="entry">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <strong>${esc(row[0])}</strong><br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${esc(row[1])}<br><br>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-edit"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  onclick="editEntry(${row[2]}, '${esc(row[0])}', '${esc(row[1])}')">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Modifica
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-delete"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  onclick="deleteEntry(${row[2]})">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Elimina
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("results").innerHTML = html;
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  .catch(() => {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("results").innerHTML = "Errore nel caricamento.";
Â  Â  Â  Â  Â  Â  });
Â  Â  }

Â  Â  loadEntries();
</script>

</body>
</html>
